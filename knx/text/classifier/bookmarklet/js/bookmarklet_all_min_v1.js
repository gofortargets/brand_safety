function sendRequest(){var e=location.href;jQuery(function(t){t(document).ready(function(){t(".modaling").length||t("body").append("<div class='modaling'></div>"),t(".loading").length||t("body").addClass("loading"),t.ajax({url:feedback_link+"/rest/get_category",jsonp:"callback",dataType:"jsonp",data:{url:e},success:function(e){if(t("body").removeClass("loading"),t(".modaling").fadeOut(500),e){var o=JSON.parse(e.categories),s=e._id;e.error?(bootbox.alert("Oops! It seems the program can't extract content from this site."),window.setTimeout(function(){bootbox.hideAll()},5e3)):o?t(".modal-dialog").length>0||(console.log("Categories: "+JSON.stringify(o)),getCategory(o,s)):(bootbox.alert("Oops! It seems the program can't extract content from this site."),window.setTimeout(function(){bootbox.hideAll()},5e3))}else bootbox.alert("Oops! It seems the program can't extract content from this site."),window.setTimeout(function(){bootbox.hideAll()},5e3)},error:function(e){console.log(JSON.stringify(e)),console.error("Error when sending ajax call"),bootbox.alert("Oops! It seems this site doesn't have article content."),window.setTimeout(function(){bootbox.hideAll()},5e3)}})})})}function getCategory(e,t){function o(e,t){!function o(){e.html(t),t--&&setTimeout(o,1e3)}()}var s="",n=[];count=0;for(var a=0;5>a;a++)s+='<ul class="list-group" style="font-size:130%">('+e[a].label+","+e[a].score+")</ul>";var i='<div class="row"><div class="col-md-12"> <form class="form-horizontal"> <div class="form-group"> <div> This article belongs to '+s+"</div>";!function(t){var o=t(i);e.forEach(function(e){e=e.label,n.push(e),o.find("input[value="+e+"]").attr("checked","checked")}),i=o.html()}(jQuery),bootbox.dialog({title:"Category classification result",message:i+'</div><div class="form-group"><div class="col-md-3"></div><span class="alert alert-info" role="alert">This popup will disappear in &nbsp;<span id="countdown" class="alert-link"></span>&nbsp; second</div></div>',show:!0,backdrop:!0,className:"dialog-position",buttons:{success:{label:"Send",className:"btn-success",callback:function(){!function(e){var o=[];e(":checkbox:checked").each(function(t){o[t]=e(this).val()});var s=location.href;data={url:s,categories_feedback:o,categories:n,_id:t},e.ajax({type:"GET",url:feedback_link+"/rest/send_feedback",dataType:"jsonp",jsonp:"callback",data:{data:JSON.stringify(data)},success:function(){bootbox.hideAll()},error:function(e){alert("error"+JSON.stringify(e)),bootbox.hideAll()}})}(jQuery)}}}}),jQuery(function(e){o(e("#countdown"),coundown_time),window.setTimeout(function(){bootbox.hideAll()},1e3*coundown_time)})}var feedback_link="http://lum-staging.knorex.com/content-extraction",coundown_time=240,noti="If wrong, please choose the most suitable category:";if(window.bootbox&&window.jQuery)sendRequest();else{for(var script_srcs=["https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js","https://lum-staging.knorex.com/static/bookmarklet/js/bootstrap.min.js","https://lum-staging.knorex.com/static/bookmarklet/js/bootbox.min.js"],css=["https://lum-staging.knorex.com/static/bookmarklet/css/bootstrap_all_min_v1.css"],i=0;i<css.length;i++){var link=document.createElement("link");link.href=css[i],link.rel="stylesheet",document.head.appendChild(link)}var modaling=document.createElement("div");modaling.className="modaling",document.getElementsByTagName("body")[0].appendChild(modaling),document.getElementsByTagName("body")[0].className="loading";for(var i=0;i<script_srcs.length;i++){var xhrObj=new XMLHttpRequest;xhrObj.open("GET",script_srcs[i],!1),xhrObj.send("");var script=document.createElement("script");script.type="text/javascript",script.text=xhrObj.responseText,document.getElementsByTagName("head")[0].appendChild(script)}jQuery(function(e){e(document).ready(function(){sendRequest()})})}